<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>å«è²¨æ˜ç´°</title>
  <style>
    :root{--border:#e5e7eb;--muted:#6b7280;--text:#111827;--ok:#059669;--bad:#b91c1c;--brand:#3b82f6;--bg:#f8fafc;--surface:#fff}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC","Helvetica Neue",Arial,sans-serif;color:var(--text);background:var(--bg);-webkit-tap-highlight-color:transparent;padding-top:env(safe-area-inset-top);padding-bottom:env(safe-area-inset-bottom)}
    .wrap{max-width:840px;margin:32px auto;padding:0 12px}
    .card{background:var(--surface);border:1px solid var(--border);border-radius:14px;box-shadow:0 6px 16px rgba(0,0,0,.06);padding:20px}
    h1{margin:0 0 14px;text-align:center;letter-spacing:.08em;font-weight:800;font-size:22px}
    .hint{color:var(--muted);margin:0 0 12px;font-size:14px}
    .table{width:100%;border-collapse:collapse;table-layout:auto;border:1px solid var(--border);border-radius:10px;overflow:hidden;background:var(--surface)}
    .table tbody tr{display:block;border-bottom:1px solid var(--border);padding:10px 12px}
    .table tbody tr:last-child{border-bottom:0}
    .table th,.table td{display:block;padding:0;vertical-align:top;word-break:break-word}
    .table th{margin:0 0 6px;color:#111827;font-weight:700;font-size:13px}
    .table td{font-size:15px;line-height:1.6}
    .muted{color:var(--muted)}
    .prewrap{white-space:pre-wrap}
    .footline{margin-top:12px;border-left:4px solid var(--brand);padding:10px 12px;color:var(--muted);border-radius:8px;background:#f8fbff;font-size:14px}
    .ok{color:var(--ok)}.bad{color:var(--bad)}
    .notice{margin-top:16px;background:#f0f9ff;border:1px solid #dbeafe;border-radius:12px;padding:14px}
    .warn{background:#fff7ed;border-color:#ffedd5}
    .small{font-size:14px}
    .bank{margin-top:12px}
    .kv{display:flex;align-items:center;justify-content:space-between;gap:8px;background:#f9fafb;border:1px solid var(--border);padding:12px;border-radius:12px}
    .btn{cursor:pointer;border:1px solid var(--border);background:#fff;border-radius:10px;padding:10px 14px;font-size:15px;touch-action:manipulation;min-width:120px}
    .btn-line{background:#06c755;border-color:#06c755;color:#fff}
    .sticky-actions{position:sticky;top:0;z-index:30;margin:12px -10px 0;padding:10px;background:#ffffffF2;backdrop-filter:blur(6px);border:1px solid var(--border);border-left:0;border-right:0;display:flex;gap:10px;flex-wrap:wrap;}
    .sticky-actions .btn{flex:1}
    .toast{margin-top:12px;padding:10px 14px;border-radius:8px;font-size:14px;display:none}
    .toast.show{display:block}
    .toast.success{background:#ecfdf5;border:1px solid #10b981;color:#065f46}
    .toast.loading{background:#eef2ff;border:1px solid #6366f1;color:#3730a3}
    .toast.error{background:#fef2f2;border:1px solid #f87171;color:#991b1b}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>å«è²¨æ˜ç´°</h1>
      <p class="hint">ä»¥ä¸‹ç‚ºæœ¬æ¬¡è¨‚å–®è³‡è¨Šï¼š</p>
      <div class="notice bank">
        <h3>åŒ¯æ¬¾è³‡è¨Š</h3>
        <div class="row">
          <div class="kv"><b>éŠ€è¡Œä»£è™Ÿ</b><span id="bank_code_txt">824ï¼ˆé€£ç·šéŠ€è¡Œï¼‰</span></div>
          <div class="kv"><b>éŠ€è¡Œå¸³è™Ÿ</b><span id="bank_acct_txt" style="font-variant-numeric:tabular-nums">111013782313</span>
            <button id="copyBtn" class="btn" type="button">è¤‡è£½å¸³è™Ÿ</button>
          </div>
        </div>
        <ul class="small" style="margin:10px 0 0 18px;line-height:1.7">
          <li>ä¸‹å–®å¾Œï¼Œ<b>æ”¶åˆ°æ¬¾é …</b>é€²è¡Œå‡ºè²¨ï¼ˆç´„ <b>3â€“5 å€‹å·¥ä½œå¤©</b>ï¼‰ã€‚</li>
          <li>å¦‚éœ€é–‹ç«‹ç™¼ç¥¨/æ”¶æ“šï¼Œéœ€åŠ æ”¶<b>ç‡Ÿæ¥­ç¨… 5%</b>ã€‚</li>
          <li>åŒ¯æ¬¾å¾Œè«‹æä¾›<b>å¾Œäº”ç¢¼</b>å‚³é€è‡³ç¸½éƒ¨å®˜æ–¹å¸³è™Ÿã€‚</li>
        </ul>
      </div>
      <div class="sticky-actions">
        <button id="btnSendLast5" class="btn btn-line" type="button">ä¸Šå‚³å¾Œäº”ç¢¼ï¼ˆé–‹å•Ÿ LINEï¼‰</button>
      </div>
      <div id="toast" class="toast"></div>
      <p id="resultLine" class="footline">æ­£åœ¨æª¢æŸ¥å¿…è¦æ¬„ä½â€¦</p>
      <table class="table">
        <tbody>
          <tr><th>è¨‚å–®æ™‚é–“</th><td id="order_time" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>è¨‚å–®ç·¨è™Ÿ</th><td id="order_id" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>ä¿¡ç®±</th><td id="email" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>åˆ†åº—åç¨±</th><td id="store_name" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>å¯„è²¨æ–¹å¼</th><td id="delivery_method" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>å–è²¨å‚™è¨»</th><td id="pickup_note" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>å•†å“æ˜ç´°</th><td id="orders" class="muted prewrap">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>å¯¦éš›é‹è²»</th><td id="shipping_fee" class="muted">ï¼ˆç©ºï¼‰</td></tr>
          <tr><th>ç¸½è¨ˆé‡‘é¡</th><td id="total_amount" class="muted">ï¼ˆç©ºï¼‰</td></tr>
        </tbody>
      </table>
    </div>
  </div>
<script>
const LINE_OA_ID = "@185jccqz";
function showToast(type, msg){
  const toast = document.getElementById('toast');
  toast.className = `toast show ${type}`;
  toast.textContent = msg;
  setTimeout(() => toast.classList.remove('show'), 4000);
}
function setCell(id,val){
  const el=document.getElementById(id);
  const v=(val==null||val==='')?'ï¼ˆç©ºï¼‰':String(val);
  el.textContent=v; el.classList.toggle('muted',v==='ï¼ˆç©ºï¼‰');
}
function readParams(){
  const map={}, usp=new URLSearchParams(location.search);
  usp.forEach((v,k)=> map[k.trim()] = v.trim());
  return map;
}
function buildMsg(p,last5){
  const parts=['ã€åŒ¯æ¬¾å¾Œäº”ç¢¼å›å ±ã€‘'];
  if(p['order_id']) parts.push('è¨‚å–®ç·¨è™Ÿï¼š'+p['order_id']);
  if(p['store_name']) parts.push('åˆ†åº—ï¼š'+p['store_name']);
  if(p['total']) parts.push('ç¸½é‡‘é¡ï¼š'+p['total']);
  parts.push('åŒ¯æ¬¾å¾Œäº”ç¢¼ï¼š'+last5);
  return parts.join('\n');
}
async function handleSendLast5(p){
  let last5 = prompt('è«‹è¼¸å…¥åŒ¯æ¬¾å¾Œäº”ç¢¼ï¼š',''); if(!last5) return;
  last5 = String(last5).trim();
  if(!/^\d{5}$/.test(last5)){ showToast('error','æ ¼å¼éŒ¯èª¤ï¼Œè«‹è¼¸å…¥ 5 ä½æ•¸å­—'); return; }
  const msg = buildMsg(p, last5);
  try{ await navigator.clipboard.writeText(msg); showToast('success','âœ… å·²è¤‡è£½è¨Šæ¯'); }
  catch{ showToast('error','âŒ è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•è¤‡è£½'); }
  showToast('loading','ğŸš€ æ­£åœ¨è·³è½‰è‡³ LINE...');
  const link = `https://line.me/R/oaMessage/${LINE_OA_ID}/?${encodeURIComponent(msg)}`;
  setTimeout(() => { window.location.href = link; }, 2000);
}
(function init(){
  const p = readParams();
  setCell('order_time', p['order_time']);
  setCell('order_id', p['order_id']);
  setCell('email', p['email']);
  setCell('store_name', p['store_name']);
  setCell('delivery_method', p['delivery_method']);
  setCell('pickup_note', p['pickup_note']);
  setCell('orders', p['order_details']);
  setCell('shipping_fee', p['shipping']);
  setCell('total_amount', p['total']);
  document.getElementById('btnSendLast5')?.addEventListener('click', ()=> handleSendLast5(p));
  document.getElementById('copyBtn')?.addEventListener('click', async ()=>{
    try{
      await navigator.clipboard.writeText(document.getElementById('bank_acct_txt').textContent.trim());
      showToast('success','ğŸ“‹ å·²è¤‡è£½å¸³è™Ÿ');
    }catch{}
  });
})();
</script>
</body>
</html>
